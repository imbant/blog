<!DOCTYPE html><html lang="zh-CN"><head><meta name="google-site-verification" content="_s8zp9HC5xK3I7RCh_8RJrSUgYtyNgc09bZvTV11nFI"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="imbant å‰ç«¯å·¥ç¨‹å¸ˆæŠ€æœ¯åšå®¢"><meta name="keywords" content="å‰ç«¯,imbant,æŠ€æœ¯åšå®¢,æµè§ˆå™¨,Electron,React,Vue,Node,Webpack,Vite,Chrome"><title>ä»æºç çœ‹ Vue ç»„ä»¶é”€æ¯åè§¦å‘å…¶äº‹ä»¶ | imbAnt's blog</title><link rel="stylesheet" type="text/css" href="/blog/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any"><link rel="Shortcut Icon" type="image/x-icon" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZM9NGRYKWS"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-ZM9NGRYKWS');
</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 6.0.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">ä»æºç çœ‹ Vue ç»„ä»¶é”€æ¯åè§¦å‘å…¶äº‹ä»¶</h1><a id="logo" href="/blog/.">imbAnt's blog</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/blog/."><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/blog/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/blog/about/"><i class="fa fa-user"> å…³äº</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><p>Hi ğŸ‘‹ï¼Œæ¬¢è¿è®¿é—®æˆ‘çš„åšå®¢</p><p>æˆ‘æ˜¯ä¸€åå‰ç«¯å¼€å‘è€…ï¼ŒVS Code æ’ä»¶å’Œè¯­è¨€æœåŠ¡å™¨å¼€å‘è€…</p><p>æˆ‘ç›®å‰æ­£åœ¨æ„å»ºåŸºäº LSP çš„ <a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=craftLandstudio.ffugclanguage">è¯­è¨€æœåŠ¡å™¨</a>ï¼Œä¹Ÿåœ¨ç»´æŠ¤ç”¨ Go æ„å»ºçš„ç¼–è¯‘å™¨ã€‚</p><p>åœ¨<a href="/about/">è¿™é‡Œ</a>æŸ¥çœ‹æ›´å¤šå…³äºæˆ‘çš„ä¿¡æ¯</p><br><p>æˆ‘å¸Œæœ›é€šè¿‡è¿™ä¸ªåšå®¢è®°å½•æŠ€æœ¯çŸ¥è¯†ï¼Œæå‡å½±å“åŠ›ã€‚å¦‚æœä½ æ„Ÿå…´è¶£ï¼Œå¯ä»¥çœ‹çœ‹è¿™äº›æ–‡ç« ï¼š</p><br><ul> <li><a href="/2024/10/29/VS-Code-Thankyou/">æˆ‘ä¸º VS Code è´¡çŒ®äº†ä»£ç </a></li><li><a href="2024/08/24/LSP1/">LSP ä¸ VS Code æ’ä»¶å¼€å‘ ç¬¬ä¸€ç« </a></li><li><a href="2023/03/30/æ€ä¹ˆè®©-favicon-åŠ¨èµ·æ¥/">æ€ä¹ˆè®© favicon åŠ¨èµ·æ¥</a></li></ul><hr><div class="post"><h1 class="post-title">ä»æºç çœ‹ Vue ç»„ä»¶é”€æ¯åè§¦å‘å…¶äº‹ä»¶</h1><div class="post-meta">2023-07-25</div><div class="post-content"><h2 id="ä»ä¸€ä¸ª-bug-è¯´èµ·"><a href="#ä»ä¸€ä¸ª-bug-è¯´èµ·" class="headerlink" title="ä»ä¸€ä¸ª bug è¯´èµ·"></a>ä»ä¸€ä¸ª bug è¯´èµ·</h2><p>è®°å½•ä¸€ä¸ª Vue ç»„ä»¶äº‹ä»¶çš„è¾¹ç•Œæƒ…å†µã€‚é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªç»„ä»¶ï¼Œæ˜¯ä¸€ä¸ªé¢æ¿ï¼Œå¯ä»¥é€šè¿‡æ‹–æ‹½æ”¹å˜è‡ªèº«å°ºå¯¸ï¼Œä¹Ÿå¯ä»¥è¢«å…³é—­ã€‚</p>
<p>é¢æ¿å°ºå¯¸æœ‰å˜åŒ–åï¼Œéœ€è¦é€šçŸ¥çˆ¶ç»„ä»¶ <code>resize</code> äº‹ä»¶ã€‚ä¾‹å¦‚ï¼Œå…¶ä»–éå“åº”å¼çš„ DOM åˆ©ç”¨è¿™ä¸ªäº‹ä»¶æ›´æ–°å°ºå¯¸<br>è€Œç‚¹å‡»å…³é—­æŒ‰é’®åï¼Œéœ€è¦é€šçŸ¥çˆ¶ç»„ä»¶ <code>close</code> äº‹ä»¶ã€‚åŒæ—¶ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ª <code>resize</code> äº‹ä»¶ã€‚</p>
<p>é¢æ¿ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- ChildComponent.vue --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;button @click=&quot;handleClick&quot;&gt;close&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleClick() &#123;</span><br><span class="line">      this.$emit(&quot;close&quot;);</span><br><span class="line"></span><br><span class="line">      // ... ä¸€å¤§æ®µå…¶ä»–é€»è¾‘å</span><br><span class="line"></span><br><span class="line">      this.$nextTick(() =&gt; &#123;</span><br><span class="line">        this.$emit(&quot;resize&quot;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    // ... å…¶ä»–è§¦å‘ resize äº‹ä»¶çš„å‡½æ•°</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ç”±äº <code>resize</code> äº‹ä»¶å’Œ DOM å˜åŒ–ç›¸å…³ï¼Œå› æ­¤æ½œæ„è¯†é‡Œä½¿ç”¨äº† <code>$nextTick</code>ã€‚è¿™ä¸º bug åŸ‹ä¸‹äº†ä¼ç¬”ã€‚</p>
<p>çˆ¶ç»„ä»¶æ”¶åˆ° <code>close</code> äº‹ä»¶åï¼Œä¼šé”€æ¯è¿™ä¸ªç»„ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- App.vue --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;ChildComponent</span><br><span class="line">    v-if=&quot;showChild&quot;</span><br><span class="line">    @close=&quot;handleClose&quot;</span><br><span class="line">    @resize=&quot;handleResize&quot;</span><br><span class="line">  /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    ChildComponent,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      showChild: true,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleClose() &#123;</span><br><span class="line">      this.showChild = false;</span><br><span class="line">    &#125;,</span><br><span class="line">    handleResize() &#123;</span><br><span class="line">      // ...</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ç°è±¡æ˜¯ï¼Œ<code>close</code> äº‹ä»¶è§¦å‘åï¼Œ<code>resize</code> äº‹ä»¶<strong>æ²¡æœ‰è§¦å‘</strong>ã€‚çˆ¶ç»„ä»¶æ²¡æœ‰æ‰§è¡Œ <code>handleResize</code></p>
<p>åŸå› å°±åœ¨äºå­ç»„ä»¶å†…ï¼Œå…ˆè§¦å‘äº† <code>close</code> äº‹ä»¶ï¼Œå¯¼è‡´è‡ªèº«é”€æ¯ï¼Œç„¶ååœ¨ <code>nextTick</code> æ‰è§¦å‘ <code>resize</code>ã€‚ä»é€»è¾‘ä¸Šï¼Œå·²ç»é”€æ¯çš„ç»„ä»¶æ— æ³•å†è§¦å‘äº‹ä»¶äº†ï¼Œæ‰€ä»¥çˆ¶ç»„ä»¶æ²¡æœ‰æ”¶åˆ°è¿™ä¸ªäº‹ä»¶ã€‚</p>
<h2 id="çœ‹çœ‹æºç "><a href="#çœ‹çœ‹æºç " class="headerlink" title="çœ‹çœ‹æºç "></a>çœ‹çœ‹æºç </h2><p>bug çš„ç›´æ¥åŸå› æ‰¾åˆ°äº†ã€‚è¿™æ¬¡ä» Vue æºç çš„è§’åº¦ï¼Œçœ‹çœ‹ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>ç”±äºç°åœ¨ï¼ˆ2023 å¹´ï¼‰Vue2 å¿«è¦ä¸ç»´æŠ¤äº†ï¼Œ<a target="_blank" rel="noopener" href="https://github.com/vuejs/vue">ä»“åº“</a>æ”¹åŠ¨ä¼šå°ä¸€äº›ï¼Œå› æ­¤ç”¨ 2 ç‰ˆæœ¬ï¼Œç›´æ¥è´´æºç çœ‹çœ‹ï¼š</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://github.com/vuejs/vue/blob/main/src/core/instance/events.ts</span></span><br><span class="line"></span><br><span class="line">Vue.prototype.$emit = <span class="function"><span class="keyword">function</span> (<span class="params">event: <span class="built_in">string</span></span>): <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> vm: Component = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">    <span class="comment">// å¼€å‘ç¯å¢ƒæ£€æŸ¥</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> cbs = vm._events[event];</span><br><span class="line">  <span class="keyword">if</span> (cbs) &#123;</span><br><span class="line">    <span class="comment">// ... è°ƒç”¨ cbs</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> vm;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>èƒ½çœ‹åˆ°ï¼Œè°ƒç”¨ <code>$emit</code> å®é™…ä¸Šæ˜¯åœ¨ç»„ä»¶çš„å®ä¾‹ <code>vm</code> ä¸Šï¼Œä» <code>_events</code> å±æ€§é‡Œæ‰¾å›è°ƒå‡½æ•°ï¼Œç„¶åè°ƒç”¨çš„ã€‚</p>
<p>åœ¨ webpack é¡¹ç›®ä¸­ï¼Œæ‰“å¼€ sourcemapï¼Œå°±èƒ½åœ¨æµè§ˆå™¨é‡Œç»™ js ç‰ˆæœ¬çš„ Vue æºç æ–­ç‚¹äº†ã€‚<br>åˆ©ç”¨æ–­ç‚¹çœ‹çœ‹ <code>close</code> å’Œ <code>resize</code> æ—¶æœ‰ä»€ä¹ˆä¸åŒ</p>
<p><code>close</code> äº‹ä»¶ï¼š<br><img src="https://imbant-blog.oss-cn-shanghai.aliyuncs.com/blog-img/vue-emit-sourcecode/emit-close.png" alt="img"></p>
<p>ç‚¹å‡»ç«‹å³è§¦å‘ <code>close</code> äº‹ä»¶æ—¶ï¼Œå®ä¾‹ä¸­æœ‰ <code>close</code> å’Œ <code>resize</code> ä¸¤ä¸ªå›è°ƒã€‚</p>
<p><code>resize</code> äº‹ä»¶ï¼š<br><img src="https://imbant-blog.oss-cn-shanghai.aliyuncs.com/blog-img/vue-emit-sourcecode/emit-resize.png" alt="img"></p>
<p>ç»è¿‡ä¸€ä¸ª tickï¼Œå®ä¾‹å·²ç»é”€æ¯ï¼ˆ<code>_isDestroyed: true</code>ï¼‰ï¼Œ<code>_events</code> å›è°ƒä¹Ÿæ¸…ç©ºäº†ï¼Œå› æ­¤ä¸ä¼šè°ƒç”¨åˆ°çˆ¶ç»„ä»¶çš„å‡½æ•°ã€‚</p>
<p>ä¸€å¥è¯æ¥è¯´ï¼Œå°±æ˜¯ <code>nextTick</code> çš„æ—¶æœºï¼Œå¦‚æœåœ¨ç»„ä»¶é”€æ¯ä¹‹åï¼Œç»„ä»¶å®ä¾‹çš„äº‹ä»¶å›è°ƒå·²ç»æ¸…ç©ºäº†ï¼Œå› æ­¤ <code>$emit</code> ä¸ä¼šç”Ÿæ•ˆã€‚</p>
<h2 id="éªŒè¯ç»“è®º"><a href="#éªŒè¯ç»“è®º" class="headerlink" title="éªŒè¯ç»“è®º"></a>éªŒè¯ç»“è®º</h2><p>æˆ‘ä»¬åŠ ä¸€äº› logï¼Œç”¨ <code>setTimeout</code> éªŒè¯è¿™ä¸ªç»“è®ºï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  ChildComponent.vue</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="function"><span class="title">handleClick</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.$emit(<span class="string">&quot;close&quot;</span>);</span><br><span class="line">      <span class="built_in">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;nextTick&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.$emit(<span class="string">&quot;resize&quot;</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;timeout&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.$emit(<span class="string">&quot;resize&quot;</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">destroyed</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;destroyed&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><img src="https://imbant-blog.oss-cn-shanghai.aliyuncs.com/blog-img/vue-emit-sourcecode/settimeout.gif" alt="img"></p>
<p>å¯è§ï¼Œè§¦å‘çˆ¶ç»„ä»¶çš„ <code>handleClose</code> åï¼Œå­ç»„ä»¶ä¼šç‡å…ˆé”€æ¯ï¼Œè€Œ <code>nextTick</code> å’Œå‰è¾¹çš„å›è°ƒéƒ½åœ¨ä¸€ä¸ªäº‹ä»¶å¾ªç¯å†…ï¼Œæ‰§è¡Œå®Œäº†ï¼Œæ‰æ‰§è¡Œ <code>setTimeout</code> çš„å®ä»»åŠ¡ã€‚</p>
<h2 id="Vue-ä»€ä¹ˆæ—¶å€™æ¸…ç†-event-å›è°ƒï¼Ÿ"><a href="#Vue-ä»€ä¹ˆæ—¶å€™æ¸…ç†-event-å›è°ƒï¼Ÿ" class="headerlink" title="Vue ä»€ä¹ˆæ—¶å€™æ¸…ç† event å›è°ƒï¼Ÿ"></a>Vue ä»€ä¹ˆæ—¶å€™æ¸…ç† event å›è°ƒï¼Ÿ</h2><p>é€šè¿‡ performance å½•åˆ¶ï¼Œæˆ‘å‘ç°ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œä¼šè°ƒç”¨ <code>$destroy</code>ï¼Œè¿™ä¸ªæ—¶æœºåº”è¯¥æ˜¯çˆ¶ç»„ä»¶æ›´æ–° virtual DOM åå‘ç°å­ç»„ä»¶å¯ä»¥é”€æ¯æ—¶ã€‚</p>
<p><img src="https://imbant-blog.oss-cn-shanghai.aliyuncs.com/blog-img/vue-emit-sourcecode/vuedestroy.png" alt="img"></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://github.com/vuejs/vue/blob/main/src/core/instance/lifecycle.ts</span></span><br><span class="line">Vue.prototype.$destroy = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> vm: Component = <span class="built_in">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// turn off all instance listeners.</span></span><br><span class="line">  vm.$off();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>é‡ç‚¹æ˜¯ <code>vm.$off();</code>ï¼Œå®ƒæ˜¯ç»„ä»¶å®ä¾‹çš„æ–¹æ³•ï¼Œç”¨äºæ‰‹åŠ¨ç§»é™¤è‡ªå®šä¹‰äº‹ä»¶ç›‘å¬å™¨ã€‚</p>
<h2 id="æ€»ç»“ä¸€ä¸‹"><a href="#æ€»ç»“ä¸€ä¸‹" class="headerlink" title="æ€»ç»“ä¸€ä¸‹"></a>æ€»ç»“ä¸€ä¸‹</h2><p>é¦–å…ˆï¼Œè°ƒç”¨ <code>$emit</code> å¯èƒ½ä¸ä¼šæ­£ç¡®è§¦å‘çˆ¶ç»„ä»¶çš„å›è°ƒï¼Œä¾‹å¦‚é€šè¿‡ <code>nextTick</code> å»¶è¿Ÿè°ƒç”¨ï¼Œè€Œæ­¤æ—¶ç»„ä»¶å·²ç»é”€æ¯æ—¶ã€‚</p>
<p>å…¶æ¬¡ï¼ŒéªŒè¯äº† <code>destroy</code> ç”Ÿå‘½å‘¨æœŸå›è°ƒä¼šæ—©äº <code>nextTick</code>ï¼Œä»–ä»¬éƒ½åœ¨ä¸€ä¸ªå®ä»»åŠ¡ä¸­ï¼Œæ—©äº <code>setTimout</code> çš„ä¸‹ä¸ªä»»åŠ¡ã€‚æ‰€ä»¥ <code>setTimeout</code> é‡Œçš„ <code>$emit</code> ä¹Ÿæ˜¯æ— æ•ˆçš„ã€‚</p>
<p>æœ€åï¼Œé€šè¿‡ç»™ webpack è®¾ç½® sourcemap çš„æ–¹å¼ï¼Œåœ¨æµè§ˆå™¨ä¸­ç»™ Vue æºç è®¾ç½®æ–­ç‚¹ï¼Œå¹¶ä¸”åˆ©ç”¨æµè§ˆå™¨çš„ Performance å·¥å…·ï¼Œå‘ç° <code>$destroy</code> ä¸­ä¼šè°ƒç”¨ <code>$off</code> æ¥æ¸…é™¤äº‹ä»¶ç›‘å¬ï¼Œæ‰€ä»¥åœ¨è¿™ä¹‹åçš„ <code>$emit</code> å·²ç»æ²¡æœ‰å›è°ƒäº†ã€‚</p>
<p>ä¸è¿‡è¿™é‡Œæ²¡æœ‰ä»»ä½• debug æ¶ˆæ¯ï¼Œä¹Ÿè®¸è¿™é‡Œå¯ä»¥ä¼˜åŒ–ä¸ºï¼Œ<code>$emit</code> è§¦å‘ä¸å­˜åœ¨çš„äº‹ä»¶æ—¶ï¼ŒæŠ›å‡ºä¸€ä¸ª warning å‘ŠçŸ¥å¼€å‘è€…ã€‚</p>
<h2 id="æµ‹è¯•ä»£ç "><a href="#æµ‹è¯•ä»£ç " class="headerlink" title="æµ‹è¯•ä»£ç "></a>æµ‹è¯•ä»£ç </h2><p>App.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;ChildComponent</span><br><span class="line">    v-if=&quot;showChild&quot;</span><br><span class="line">    @close=&quot;handleClose&quot;</span><br><span class="line">    @resize=&quot;handleResize&quot;</span><br><span class="line">  /&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import ChildComponent from &quot;./components/ChildComponent.vue&quot;;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  components: &#123;</span><br><span class="line">    ChildComponent,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      showChild: true,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleClose() &#123;</span><br><span class="line">      console.log(&quot;parent: handleClose&quot;);</span><br><span class="line">      this.showChild = false;</span><br><span class="line">    &#125;,</span><br><span class="line">    handleResize() &#123;</span><br><span class="line">      console.log(&quot;parent: handleResize&quot;);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ChildComponent.vue</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;button @click=&quot;handleClick&quot;&gt;close&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleClick() &#123;</span><br><span class="line">      this.$emit(&quot;close&quot;);</span><br><span class="line">      setTimeout(() =&gt; &#123;</span><br><span class="line">        console.log(&quot;child: timeout&quot;);</span><br><span class="line">        this.$emit(&quot;resize&quot;);</span><br><span class="line">      &#125;);</span><br><span class="line">      this.$nextTick(() =&gt; &#123;</span><br><span class="line">        console.log(&quot;child: nextTick&quot;);</span><br><span class="line">        this.$emit(&quot;resize&quot;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  destroyed() &#123;</span><br><span class="line">    console.log(&quot;child: destroyed&quot;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</div><div class="tags"><a href="/blog/tags/Vue/"><i class="fa fa-tag"></i>Vue</a></div><div class="post-nav"><a class="pre" href="/blog/2023/08/21/RubyConf-China-2023-%E7%AC%94%E8%AE%B0/">RubyConf China 2023 ç¬”è®°</a><a class="next" href="/blog/2023/03/30/%E6%80%8E%E4%B9%88%E8%AE%A9-favicon-%E5%8A%A8%E8%B5%B7%E6%9D%A5/">æ€ä¹ˆè®© favicon åŠ¨èµ·æ¥</a></div><div class="giscus"></div><script src="https://giscus.app/client.js" data-repo="imbant/blog" data-repo-id="MDEwOlJlcG9zaXRvcnkyNDkzOTc0NDM=" data-category="General" data-category-id="DIC_kwDODt2Aw84Ch79K" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="zh-CN" crossorigin="anonymous" async></script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://imbant.github.io/blog"/></form></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer"><span id="footer-copyright">Copyright Â© </span><a href="/blog/." rel="nofollow">imbAnt's blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a><script>const tag = document.getElementById('footer-copyright');const year = new Date().getFullYear();tag.innerText += year + ' ';</script></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/blog/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/blog/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/blog/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/blog/js/smartresize.js?v=1.0.0"></script><script type="text/javascript" src="/blog/js/gifFavIcon.js"></script></div></body></html>