---
// src/layouts/BlogPost.astro
import BaseLayout from './BaseLayout.astro';

export interface Props {
  post: any;
}

const { post } = Astro.props;
const { title, description, date, tags } = post.data;
---

<BaseLayout title={`${title} | imbAnt's blog`} description={description}>
  <main class="container">
    <article class="post">
      <header class="post-header">
        <h1 class="post-title">{title}</h1>
        <div class="post-meta">
          <time>{date.toISOString().split('T')[0]}</time>
          {tags && tags.length > 0 && (
            <div class="post-tags">
              {tags.map((tag: string) => (
                <span class="tag">#{tag}</span>
              ))}
            </div>
          )}
        </div>
      </header>
      
      <div class="post-content">
        <slot />
      </div>
      
      <!-- Giscus Comments -->
      {post.data.comments !== false && (
        <div class="giscus" id="giscus-container">
          <script>
            const script = document.createElement('script');
            script.src = 'https://giscus.app/client.js';
            script.setAttribute('data-repo', 'imbant/blog');
            script.setAttribute('data-repo-id', 'MDEwOlJlcG9zaXRvcnkyNDkzOTc0NDM=');
            script.setAttribute('data-category', 'General');
            script.setAttribute('data-category-id', 'DIC_kwDODt2Aw84Ch79K');
            script.setAttribute('data-mapping', 'pathname');
            script.setAttribute('data-strict', '0');
            script.setAttribute('data-reactions-enabled', '1');
            script.setAttribute('data-emit-metadata', '0');
            script.setAttribute('data-input-position', 'bottom');
            script.setAttribute('data-theme', 'preferred_color_scheme');
            script.setAttribute('data-lang', 'zh-CN');
            script.setAttribute('crossorigin', 'anonymous');
            script.async = true;
            document.getElementById('giscus-container').appendChild(script);
          </script>
        </div>
      )}
    </article>
  </main>
</BaseLayout>

<style>
  .container {
    max-width: 800px;
    margin: 0 auto;
    padding: 2rem;
  }
  
  .post {
    margin-bottom: 2rem;
  }
  
  .post-header {
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #eee;
  }
  
  .post-title {
    font-size: 2rem;
    margin-bottom: 1rem;
    line-height: 1.3;
  }
  
  .post-meta {
    display: flex;
    align-items: center;
    gap: 1rem;
    color: #666;
    font-size: 0.9rem;
  }
  
  .post-tags {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
  }
  
  .tag {
    background: #f1f1f1;
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.8rem;
  }
  
  .post-content {
    line-height: 1.8;
  }
  
  .post-content h2, .post-content h3, .post-content h4 {
    margin: 2rem 0 1rem 0;
    line-height: 1.3;
  }
  
  .post-content p {
    margin-bottom: 1rem;
  }
  
  .post-content pre {
    background: #f8f9fa;
    padding: 1rem;
    border-radius: 0.25rem;
    overflow-x: auto;
    margin: 1rem 0;
  }
  
  .post-content code {
    background: #f1f1f1;
    padding: 0.1rem 0.3rem;
    border-radius: 0.2rem;
    font-size: 0.9rem;
  }
  
  .post-content pre code {
    background: none;
    padding: 0;
  }
  
  .post-content blockquote {
    border-left: 4px solid #ddd;
    margin: 1rem 0;
    padding-left: 1rem;
    color: #666;
  }
  
  .giscus {
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 1px solid #eee;
  }
</style>